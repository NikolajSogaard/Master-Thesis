<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weekly Strength Training Program</title>
  <style>
    table, th, td {
      border: 1px solid #333;
      border-collapse: collapse;
      padding: 5px;
    }
    th, td { text-align: left; }
    .container { width: 80%; margin: auto; }
    .set-input {
      display: inline-block;
      margin-right: 10px;
    }
    .feedback-input {
      width: 100%;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>Weekly Strength Training Program</h1>
  <form action="{{ url_for('submit_feedback') }}" method="post">
    {% for day, exercises in program.items() %}
      <h2>{{ day }}</h2>
      <table style="width:100%; margin-bottom:20px;">
        <thead>
          <tr>
            <th>Exercise</th>
            <th>Sets x Reps</th>
            <th>Target RPE</th>
            <th>Rest</th>
            <th>Cues</th>
            <th>Set Feedback<br/>(Inline inputs)</th>
            <th>Overall Feedback<br/>(Free Text)</th>
          </tr>
        </thead>
        <tbody>
          {% for exercise_index in range(exercises|length) %}
          {% set exercise = exercises[exercise_index] %}
          <tr>
            <td>
              {{ exercise.name }}
              <!-- Hidden field to capture exercise name -->
              <input type="hidden" name="{{ day.replace(' ', '') }}_ex{{ exercise_index }}_name" value="{{ exercise.name }}">
            </td>
            <td>{{ exercise.sets }} x {{ exercise.reps }}</td>
            <td>{{ exercise.target_rpe }}</td>
            <td>{{ exercise.rest }}</td>
            <td>{{ exercise.cues }}</td>
            <td>
              {% for i in range(exercise.sets) %}
                <div class="set-input">
                  <strong>Set {{ i+1 }}:</strong>
                  Weight: <input type="number" step="0.1" name="{{ day.replace(' ', '') }}_ex{{ exercise_index }}_set{{ i }}_weight" required>
                  Reps: <input type="number" name="{{ day.replace(' ', '') }}_ex{{ exercise_index }}_set{{ i }}_reps" required>
                  RPE: <input type="number" step="0.1" name="{{ day.replace(' ', '') }}_ex{{ exercise_index }}_set{{ i }}_actual_rpe" required>
                </div>
              {% endfor %}
            </td>
            <td>
              <input type="text" name="{{ day.replace(' ', '') }}_ex{{ exercise_index }}_feedback" class="feedback-input" placeholder="Your overall feedback">
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endfor %}
    <button type="submit">Submit Feedback</button>
  </form>
  <br>
  <a href="{{ url_for('next_week') }}">
    <button>Generate Next Week's Program</button>
  </a>
</div>
</body>
</html>
